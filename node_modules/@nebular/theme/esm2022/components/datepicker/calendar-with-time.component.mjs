import { ChangeDetectionStrategy, Component, Input, ViewChild, } from '@angular/core';
import { NbCalendarComponent } from '../calendar/calendar.component';
import { NbCalendarSize } from '../calendar-kit/model';
import { NbPortalOutletDirective } from '../cdk/overlay/mapping';
import { NbTimePickerComponent } from '../timepicker/timepicker.component';
import * as i0 from "@angular/core";
import * as i1 from "../calendar-kit/services/date.service";
import * as i2 from "../calendar-kit/services/calendar-time-model.service";
import * as i3 from "../cdk/overlay/mapping";
import * as i4 from "../card/card.component";
import * as i5 from "../calendar/base-calendar.component";
import * as i6 from "../timepicker/timepicker.component";
import * as i7 from "../calendar-kit/components/calendar-actions/calendar-actions.component";
export class NbCalendarWithTimeComponent extends NbCalendarComponent {
    constructor(dateService, cd, calendarTimeModelService) {
        super();
        this.dateService = dateService;
        this.cd = cd;
        this.calendarTimeModelService = calendarTimeModelService;
    }
    ngOnInit() {
        if (!this.date) {
            this.date = this.calendarTimeModelService.getResetTime();
        }
    }
    ngAfterViewInit() {
        this.portalOutlet.attachTemplatePortal(this.timepicker.portal);
    }
    onDateValueChange(date) {
        const hours = this.dateService.getHours(this.date);
        const minutes = this.dateService.getMinutes(this.date);
        const seconds = this.dateService.getSeconds(this.date);
        const milliseconds = this.dateService.getMilliseconds(this.date);
        let newDate = this.dateService.setHours(date, hours);
        newDate = this.dateService.setMinutes(newDate, minutes);
        newDate = this.dateService.setMinutes(newDate, minutes);
        newDate = this.dateService.setSeconds(newDate, seconds);
        newDate = this.dateService.setMilliseconds(newDate, milliseconds);
        this.date = newDate;
    }
    onTimeChange(selectedTime) {
        let newDate = this.dateService.clone(this.date);
        newDate = this.dateService.setHours(newDate, this.dateService.getHours(selectedTime.time));
        newDate = this.dateService.setMinutes(newDate, this.dateService.getMinutes(selectedTime.time));
        newDate = this.dateService.setSeconds(newDate, this.dateService.getSeconds(selectedTime.time));
        newDate = this.dateService.setMilliseconds(newDate, this.dateService.getMilliseconds(selectedTime.time));
        this.date = newDate;
    }
    saveValue() {
        this.dateChange.emit(this.date);
    }
    saveCurrentTime() {
        this.dateChange.emit(this.dateService.today());
    }
    showSeconds() {
        return this.withSeconds && !this.singleColumn;
    }
    isLarge() {
        return this.size === NbCalendarSize.LARGE;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: NbCalendarWithTimeComponent, deps: [{ token: i1.NbDateService }, { token: i0.ChangeDetectorRef }, { token: i2.NbCalendarTimeModelService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.12", type: NbCalendarWithTimeComponent, selector: "nb-calendar-with-time", inputs: { visibleDate: "visibleDate", twelveHoursFormat: "twelveHoursFormat", showAmPmLabel: "showAmPmLabel", withSeconds: "withSeconds", singleColumn: "singleColumn", step: "step", timeFormat: "timeFormat", title: "title", applyButtonText: "applyButtonText", currentTimeButtonText: "currentTimeButtonText", showCurrentTimeButton: "showCurrentTimeButton" }, viewQueries: [{ propertyName: "portalOutlet", first: true, predicate: NbPortalOutletDirective, descendants: true }, { propertyName: "timepicker", first: true, predicate: NbTimePickerComponent, descendants: true }], usesInheritance: true, ngImport: i0, template: `
    <nb-card class="calendar-with-time">
      <nb-card-body class="picker-body">
        <nb-base-calendar
          [boundingMonth]="boundingMonth"
          [startView]="startView"
          [date]="date"
          [min]="min"
          [max]="max"
          [filter]="filter"
          [dayCellComponent]="dayCellComponent"
          [monthCellComponent]="monthCellComponent"
          [yearCellComponent]="yearCellComponent"
          [size]="size"
          [visibleDate]="visibleDate"
          [showNavigation]="showNavigation"
          [showWeekNumber]="showWeekNumber"
          [weekNumberSymbol]="weekNumberSymbol"
          [firstDayOfWeek]="firstDayOfWeek"
          (dateChange)="onDateValueChange($event)"
        >
        </nb-base-calendar>
        <div
          class="timepicker-section"
          [class.size-large]="isLarge()"
          [class.timepicker-single-column-width]="singleColumn"
          [class.timepicker-multiple-column-width]="!singleColumn"
        >
          <div class="picker-title">{{ title }}</div>
          <nb-timepicker
            (onSelectTime)="onTimeChange($event)"
            [date]="date"
            [twelveHoursFormat]="twelveHoursFormat"
            [showAmPmLabel]="showAmPmLabel"
            [withSeconds]="showSeconds()"
            [showFooter]="false"
            [singleColumn]="singleColumn"
            [step]="step"
          >
          </nb-timepicker>
          <ng-container nbPortalOutlet></ng-container>
        </div>
      </nb-card-body>
      <nb-card-footer class="picker-footer">
        <nb-calendar-actions
          [applyButtonText]="applyButtonText"
          [currentTimeButtonText]="currentTimeButtonText"
          [showCurrentTimeButton]="showCurrentTimeButton"
          (setCurrentTime)="saveCurrentTime()"
          (saveValue)="saveValue()"
        ></nb-calendar-actions>
      </nb-card-footer>
    </nb-card>
  `, isInline: true, styles: ["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n*//**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */:host ::ng-deep nb-card.nb-timepicker-container{flex:1 0 0;border-radius:0;width:auto;border-right:0;border-bottom:0}[dir=ltr] :host .picker-footer{padding-left:.625rem}[dir=rtl] :host .picker-footer{padding-right:.625rem}.picker-body{align-items:stretch;display:flex;padding:0}.picker-body nb-base-calendar ::ng-deep nb-card{border-radius:0}.calendar-with-time{overflow:hidden}.timepicker-section{display:flex;flex-direction:column}\n"], dependencies: [{ kind: "directive", type: i3.NbPortalOutletDirective, selector: "[nbPortalOutlet]" }, { kind: "component", type: i4.NbCardComponent, selector: "nb-card", inputs: ["size", "status", "accent"] }, { kind: "component", type: i4.NbCardBodyComponent, selector: "nb-card-body" }, { kind: "component", type: i4.NbCardFooterComponent, selector: "nb-card-footer" }, { kind: "component", type: i5.NbBaseCalendarComponent, selector: "nb-base-calendar", inputs: ["boundingMonth", "startView", "min", "max", "filter", "dayCellComponent", "monthCellComponent", "yearCellComponent", "size", "visibleDate", "showNavigation", "date", "showWeekNumber", "weekNumberSymbol", "firstDayOfWeek"], outputs: ["dateChange"] }, { kind: "component", type: i6.NbTimePickerComponent, selector: "nb-timepicker", inputs: ["timeFormat", "twelveHoursFormat", "showAmPmLabel", "withSeconds", "singleColumn", "step", "date", "showFooter", "applyButtonText", "hoursText", "minutesText", "secondsText", "ampmText", "currentTimeButtonText"], outputs: ["onSelectTime"], exportAs: ["nbTimepicker"] }, { kind: "component", type: i7.NbCalendarActionsComponent, selector: "nb-calendar-actions", inputs: ["applyButtonText", "currentTimeButtonText", "showCurrentTimeButton"], outputs: ["setCurrentTime", "saveValue"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: NbCalendarWithTimeComponent, decorators: [{
            type: Component,
            args: [{ selector: 'nb-calendar-with-time', template: `
    <nb-card class="calendar-with-time">
      <nb-card-body class="picker-body">
        <nb-base-calendar
          [boundingMonth]="boundingMonth"
          [startView]="startView"
          [date]="date"
          [min]="min"
          [max]="max"
          [filter]="filter"
          [dayCellComponent]="dayCellComponent"
          [monthCellComponent]="monthCellComponent"
          [yearCellComponent]="yearCellComponent"
          [size]="size"
          [visibleDate]="visibleDate"
          [showNavigation]="showNavigation"
          [showWeekNumber]="showWeekNumber"
          [weekNumberSymbol]="weekNumberSymbol"
          [firstDayOfWeek]="firstDayOfWeek"
          (dateChange)="onDateValueChange($event)"
        >
        </nb-base-calendar>
        <div
          class="timepicker-section"
          [class.size-large]="isLarge()"
          [class.timepicker-single-column-width]="singleColumn"
          [class.timepicker-multiple-column-width]="!singleColumn"
        >
          <div class="picker-title">{{ title }}</div>
          <nb-timepicker
            (onSelectTime)="onTimeChange($event)"
            [date]="date"
            [twelveHoursFormat]="twelveHoursFormat"
            [showAmPmLabel]="showAmPmLabel"
            [withSeconds]="showSeconds()"
            [showFooter]="false"
            [singleColumn]="singleColumn"
            [step]="step"
          >
          </nb-timepicker>
          <ng-container nbPortalOutlet></ng-container>
        </div>
      </nb-card-body>
      <nb-card-footer class="picker-footer">
        <nb-calendar-actions
          [applyButtonText]="applyButtonText"
          [currentTimeButtonText]="currentTimeButtonText"
          [showCurrentTimeButton]="showCurrentTimeButton"
          (setCurrentTime)="saveCurrentTime()"
          (saveValue)="saveValue()"
        ></nb-calendar-actions>
      </nb-card-footer>
    </nb-card>
  `, changeDetection: ChangeDetectionStrategy.OnPush, styles: ["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n*//**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */:host ::ng-deep nb-card.nb-timepicker-container{flex:1 0 0;border-radius:0;width:auto;border-right:0;border-bottom:0}[dir=ltr] :host .picker-footer{padding-left:.625rem}[dir=rtl] :host .picker-footer{padding-right:.625rem}.picker-body{align-items:stretch;display:flex;padding:0}.picker-body nb-base-calendar ::ng-deep nb-card{border-radius:0}.calendar-with-time{overflow:hidden}.timepicker-section{display:flex;flex-direction:column}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.NbDateService }, { type: i0.ChangeDetectorRef }, { type: i2.NbCalendarTimeModelService }]; }, propDecorators: { visibleDate: [{
                type: Input
            }], twelveHoursFormat: [{
                type: Input
            }], showAmPmLabel: [{
                type: Input
            }], withSeconds: [{
                type: Input
            }], singleColumn: [{
                type: Input
            }], step: [{
                type: Input
            }], timeFormat: [{
                type: Input
            }], title: [{
                type: Input
            }], applyButtonText: [{
                type: Input
            }], currentTimeButtonText: [{
                type: Input
            }], showCurrentTimeButton: [{
                type: Input
            }], portalOutlet: [{
                type: ViewChild,
                args: [NbPortalOutletDirective]
            }], timepicker: [{
                type: ViewChild,
                args: [NbTimePickerComponent]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItd2l0aC10aW1lLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9mcmFtZXdvcmsvdGhlbWUvY29tcG9uZW50cy9kYXRlcGlja2VyL2NhbGVuZGFyLXdpdGgtdGltZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUVMLHVCQUF1QixFQUV2QixTQUFTLEVBQ1QsS0FBSyxFQUVMLFNBQVMsR0FDVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUlyRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDdkQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDakUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7Ozs7Ozs7OztBQTZEM0UsTUFBTSxPQUFPLDJCQUErQixTQUFRLG1CQUFzQjtJQW9EeEUsWUFDWSxXQUE2QixFQUNoQyxFQUFxQixFQUNsQix3QkFBdUQ7UUFFakUsS0FBSyxFQUFFLENBQUM7UUFKRSxnQkFBVyxHQUFYLFdBQVcsQ0FBa0I7UUFDaEMsT0FBRSxHQUFGLEVBQUUsQ0FBbUI7UUFDbEIsNkJBQXdCLEdBQXhCLHdCQUF3QixDQUErQjtJQUduRSxDQUFDO0lBRUQsUUFBUTtRQUNOLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ2QsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsd0JBQXdCLENBQUMsWUFBWSxFQUFFLENBQUM7U0FDMUQ7SUFDSCxDQUFDO0lBRUQsZUFBZTtRQUNiLElBQUksQ0FBQyxZQUFZLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBRUQsaUJBQWlCLENBQUMsSUFBTztRQUN2QixNQUFN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Qjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FxRFQsbUJBRWdCLHVCQUF1QixDQUFDLE1BQU07NktBTXRDLFdBQVc7c0JBQW5CLEtBQUs7Z0JBS0csaUJBQWlCO3NCQUF6QixLQUFLO2dCQUtHLGFBQWE7c0JBQXJCLEtBQUs7Z0JBTUcsV0FBVztzQkFBbkIsS0FBSztnQkFLRyxZQUFZO3NCQUFwQixLQUFLO2dCQU1HLElBQUk7c0JBQVosS0FBSztnQkFLRyxVQUFVO3NCQUFsQixLQUFLO2dCQUtHLEtBQUs7c0JBQWIsS0FBSztnQkFFRyxlQUFlO3NCQUF2QixLQUFLO2dCQUVHLHFCQUFxQjtzQkFBN0IsS0FBSztnQkFFRyxxQkFBcUI7c0JBQTdCLEtBQUs7Z0JBRThCLFlBQVk7c0JBQS9DLFNBQVM7dUJBQUMsdUJBQXVCO2dCQUNBLFVBQVU7c0JBQTNDLFNBQVM7dUJBQUMscUJBQXFCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBDb21wb25lbnQsXG4gIElucHV0LFxuICBPbkluaXQsXG4gIFZpZXdDaGlsZCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOYkNhbGVuZGFyQ29tcG9uZW50IH0gZnJvbSAnLi4vY2FsZW5kYXIvY2FsZW5kYXIuY29tcG9uZW50JztcbmltcG9ydCB7IE5iU2VsZWN0ZWRUaW1lUGF5bG9hZCB9IGZyb20gJy4uL3RpbWVwaWNrZXIvbW9kZWwnO1xuaW1wb3J0IHsgTmJEYXRlU2VydmljZSB9IGZyb20gJy4uL2NhbGVuZGFyLWtpdC9zZXJ2aWNlcy9kYXRlLnNlcnZpY2UnO1xuaW1wb3J0IHsgTmJDYWxlbmRhclRpbWVNb2RlbFNlcnZpY2UgfSBmcm9tICcuLi9jYWxlbmRhci1raXQvc2VydmljZXMvY2FsZW5kYXItdGltZS1tb2RlbC5zZXJ2aWNlJztcbmltcG9ydCB7IE5iQ2FsZW5kYXJTaXplIH0gZnJvbSAnLi4vY2FsZW5kYXIta2l0L21vZGVsJztcbmltcG9ydCB7IE5iUG9ydGFsT3V0bGV0RGlyZWN0aXZlIH0gZnJvbSAnLi4vY2RrL292ZXJsYXkvbWFwcGluZyc7XG5pbXBvcnQgeyBOYlRpbWVQaWNrZXJDb21wb25lbnQgfSBmcm9tICcuLi90aW1lcGlja2VyL3RpbWVwaWNrZXIuY29tcG9uZW50JztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmItY2FsZW5kYXItd2l0aC10aW1lJyxcbiAgdGVtcGxhdGU6IGBcbiAgICA8bmItY2FyZCBjbGFzcz1cImNhbGVuZGFyLXdpdGgtdGltZVwiPlxuICAgICAgPG5iLWNhcmQtYm9keSBjbGFzcz1cInBpY2tlci1ib2R5XCI+XG4gICAgICAgIDxuYi1iYXNlLWNhbGVuZGFyXG4gICAgICAgICAgW2JvdW5kaW5nTW9udGhdPVwiYm91bmRpbmdNb250aFwiXG4gICAgICAgICAgW3N0YXJ0Vmlld109XCJzdGFydFZpZXdcIlxuICAgICAgICAgIFtkYXRlXT1cImRhdGVcIlxuICAgICAgICAgIFttaW5dPVwibWluXCJcbiAgICAgICAgICBbbWF4XT1cIm1heFwiXG4gICAgICAgICAgW2ZpbHRlcl09XCJmaWx0ZXJcIlxuICAgICAgICAgIFtkYXlDZWxsQ29tcG9uZW50XT1cImRheUNlbGxDb21wb25lbnRcIlxuICAgICAgICAgIFttb250aENlbGxDb21wb25lbnRdPVwibW9udGhDZWxsQ29tcG9uZW50XCJcbiAgICAgICAgICBbeWVhckNlbGxDb21wb25lbnRdPVwieWVhckNlbGxDb21wb25lbnRcIlxuICAgICAgICAgIFtzaXplXT1cInNpemVcIlxuICAgICAgICAgIFt2aXNpYmxlRGF0ZV09XCJ2aXNpYmxlRGF0ZVwiXG4gICAgICAgICAgW3Nob3dOYXZpZ2F0aW9uXT1cInNob3dOYXZpZ2F0aW9uXCJcbiAgICAgICAgICBbc2hvd1dlZWtOdW1iZXJdPVwic2hvd1dlZWtOdW1iZXJcIlxuICAgICAgICAgIFt3ZWVrTnVtYmVyU3ltYm9sXT1cIndlZWtOdW1iZXJTeW1ib2xcIlxuICAgICAgICAgIFtmaXJzdERheU9mV2Vla109XCJmaXJzdERheU9mV2Vla1wiXG4gICAgICAgICAgKGRhdGVDaGFuZ2UpPVwib25EYXRlVmFsdWVDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgID5cbiAgICAgICAgPC9uYi1iYXNlLWNhbGVuZGFyPlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgY2xhc3M9XCJ0aW1lcGlja2VyLXNlY3Rpb25cIlxuICAgICAgICAgIFtjbGFzcy5zaXplLWxhcmdlXT1cImlzTGFyZ2UoKVwiXG4gICAgICAgICAgW2NsYXNzLnRpbWVwaWNrZXItc2luZ2xlLWNvbHVtbi13aWR0aF09XCJzaW5nbGVDb2x1bW5cIlxuICAgICAgICAgIFtjbGFzcy50aW1lcGlja2VyLW11bHRpcGxlLWNvbHVtbi13aWR0aF09XCIhc2luZ2xlQ29sdW1uXCJcbiAgICAgICAgPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJwaWNrZXItdGl0bGVcIj57eyB0aXRsZSB9fTwvZGl2PlxuICAgICAgICAgIDxuYi10aW1lcGlja2VyXG4gICAgICAgICAgICAob25TZWxlY3RUaW1lKT1cIm9uVGltZUNoYW5nZSgkZXZlbnQpXCJcbiAgICAgICAgICAgIFtkYXRlXT1cImRhdGVcIlxuICAgICAgICAgICAgW3R3ZWx2ZUhvdXJzRm9ybWF0XT1cInR3ZWx2ZUhvdXJzRm9ybWF0XCJcbiAgICAgICAgICAgIFtzaG93QW1QbUxhYmVsXT1cInNob3dBbVBtTGFiZWxcIlxuICAgICAgICAgICAgW3dpdGhTZWNvbmRzXT1cInNob3dTZWNvbmRzKClcIlxuICAgICAgICAgICAgW3Nob3dGb290ZXJdPVwiZmFsc2VcIlxuICAgICAgICAgICAgW3NpbmdsZUNvbHVtbl09XCJzaW5nbGVDb2x1bW5cIlxuICAgICAgICAgICAgW3N0ZXBdPVwic3RlcFwiXG4gICAgICAgICAgPlxuICAgICAgICAgIDwvbmItdGltZXBpY2tlcj5cbiAgICAgICAgICA8bmctY29udGFpbmVyIG5iUG9ydGFsT3V0bGV0PjwvbmctY29udGFpbmVyPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvbmItY2FyZC1ib2R5PlxuICAgICAgPG5iLWNhcmQtZm9vdGVyIGNsYXNzPVwicGlja2VyLWZvb3RlclwiPlxuICAgICAgICA8bmItY2FsZW5kYXItYWN0aW9uc1xuICAgICAgICAgIFthcHBseUJ1dHRvblRleHRdPVwiYXBwbHlCdXR0b25UZXh0XCJcbiAgICAgICAgICBbY3VycmVudFRpbWVCdXR0b25UZXh0XT1cImN1cnJlbnRUaW1lQnV0dG9uVGV4dFwiXG4gICAgICAgICAgW3Nob3dDdXJyZW50VGltZUJ1dHRvbl09XCJzaG93Q3VycmVudFRpbWVCdXR0b25cIlxuICAgICAgICAgIChzZXRDdXJyZW50VGltZSk9XCJzYXZlQ3VycmVudFRpbWUoKVwiXG4gICAgICAgICAgKHNhdmVWYWx1ZSk9XCJzYXZlVmFsdWUoKVwiXG4gICAgICAgID48L25iLWNhbGVuZGFyLWFjdGlvbnM+XG4gICAgICA8L25iLWNhcmQtZm9vdGVyPlxuICAgIDwvbmItY2FyZD5cbiAgYCxcbiAgc3R5bGVVcmxzOiBbJy4vY2FsZW5kYXItd2l0aC10aW1lLWNvbnRhaW5lci5jb21wb25lbnQuc2NzcyddLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgTmJDYWxlbmRhcldpdGhUaW1lQ29tcG9uZW50PEQ+IGV4dGVuZHMgTmJDYWxlbmRhckNvbXBvbmVudDxEPiBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XG4gIC8qKlxuICAgKiBEZWZpbmVzIHNlbGVjdGVkIGRhdGUuXG4gICAqICovXG4gIEBJbnB1dCgpIHZpc2libGVEYXRlOiBEO1xuXG4gIC8qKlxuICAgKiBEZWZpbmVzIDEyIGhvdXJzIGZvcm1hdCBsaWtlICcwNzowMCBQTScuXG4gICAqICovXG4gIEBJbnB1dCgpIHR3ZWx2ZUhvdXJzRm9ybWF0OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBEZWZpbmVzIHNob3VsZCBzaG93IGFtL3BtIGxhYmVsIGlmIHR3ZWx2ZUhvdXJzRm9ybWF0IGVuYWJsZWQuXG4gICAqICovXG4gIEBJbnB1dCgpIHNob3dBbVBtTGFiZWw6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFNob3cgc2Vjb25kcyBpbiB0aW1lcGlja2VyLlxuICAgKiBJZ25vcmVkIHdoZW4gc2luZ2xlQ29sdW1uIGlzIHRydWUuXG4gICAqICovXG4gIEBJbnB1dCgpIHdpdGhTZWNvbmRzOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBTaG93IHRpbWVwaWNrZXIgdmFsdWVzIGluIG9uZSBjb2x1bW4gd2l0aCA2MCBtaW51dGVzIHN0ZXAgYnkgZGVmYXVsdC5cbiAgICogKi9cbiAgQElucHV0KCkgc2luZ2xlQ29sdW1uOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBEZWZpbmVzIG1pbnV0ZXMgc3RlcCB3aGVuIHdlIHVzZSBmaWxsIHRpbWUgZm9ybWF0LlxuICAgKiBJZiBzZXQgdG8gMjAsIGl0IHdpbGwgYmU6ICcxMjowMCwgMTI6MjA6IDEyOjQwLCAxMzowMC4uLidcbiAgICogKi9cbiAgQElucHV0KCkgc3RlcDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZpbmVzIHRpbWUgZm9ybWF0LlxuICAgKiAqL1xuICBASW5wdXQoKSB0aW1lRm9ybWF0OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIERlZmluZXMgdGV4dCBvdmVyIHRoZSB0aW1lcGlja2VyLlxuICAgKiAqL1xuICBASW5wdXQoKSB0aXRsZTogc3RyaW5nO1xuXG4gIEBJbnB1dCgpIGFwcGx5QnV0dG9uVGV4dDogc3RyaW5nO1xuXG4gIEBJbnB1dCgpIGN1cnJlbnRUaW1lQnV0dG9uVGV4dDogc3RyaW5nO1xuXG4gIEBJbnB1dCgpIHNob3dDdXJyZW50VGltZUJ1dHRvbjogYm9vbGVhbjtcblxuICBAVmlld0NoaWxkKE5iUG9ydGFsT3V0bGV0RGlyZWN0aXZlKSBwb3J0YWxPdXRsZXQ6IE5iUG9ydGFsT3V0bGV0RGlyZWN0aXZlO1xuICBAVmlld0NoaWxkKE5iVGltZVBpY2tlckNvbXBvbmVudCkgdGltZXBpY2tlcjogTmJUaW1lUGlja2VyQ29tcG9uZW50PEQ+O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCBkYXRlU2VydmljZTogTmJEYXRlU2VydmljZTxEPixcbiAgICBwdWJsaWMgY2Q6IENoYW5nZURldGVjdG9yUmVmLFxuICAgIHByb3RlY3RlZCBjYWxlbmRhclRpbWVNb2RlbFNlcnZpY2U6IE5iQ2FsZW5kYXJUaW1lTW9kZWxTZXJ2aWNlPEQ+LFxuICApIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmRhdGUpIHtcbiAgICAgIHRoaXMuZGF0ZSA9IHRoaXMuY2FsZW5kYXJUaW1lTW9kZWxTZXJ2aWNlLmdldFJlc2V0VGltZSgpO1xuICAgIH1cbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICB0aGlzLnBvcnRhbE91dGxldC5hdHRhY2hUZW1wbGF0ZVBvcnRhbCh0aGlzLnRpbWVwaWNrZXIucG9ydGFsKTtcbiAgfVxuXG4gIG9uRGF0ZVZhbHVlQ2hhbmdlKGRhdGU6IEQpOiB2b2lkIHtcbiAgICBjb25zdCBob3VycyA9IHRoaXMuZGF0ZVNlcnZpY2UuZ2V0SG91cnModGhpcy5kYXRlKTtcbiAgICBjb25zdCBtaW51dGVzID0gdGhpcy5kYXRlU2VydmljZS5nZXRNaW51dGVzKHRoaXMuZGF0ZSk7XG4gICAgY29uc3Qgc2Vjb25kcyA9IHRoaXMuZGF0ZVNlcnZpY2UuZ2V0U2Vjb25kcyh0aGlzLmRhdGUpO1xuICAgIGNvbnN0IG1pbGxpc2Vjb25kcyA9IHRoaXMuZGF0ZVNlcnZpY2UuZ2V0TWlsbGlzZWNvbmRzKHRoaXMuZGF0ZSk7XG5cbiAgICBsZXQgbmV3RGF0ZSA9IHRoaXMuZGF0ZVNlcnZpY2Uuc2V0SG91cnMoZGF0ZSwgaG91cnMpO1xuICAgIG5ld0RhdGUgPSB0aGlzLmRhdGVTZXJ2aWNlLnNldE1pbnV0ZXMobmV3RGF0ZSwgbWludXRlcyk7XG4gICAgbmV3RGF0ZSA9IHRoaXMuZGF0ZVNlcnZpY2Uuc2V0TWludXRlcyhuZXdEYXRlLCBtaW51dGVzKTtcbiAgICBuZXdEYXRlID0gdGhpcy5kYXRlU2VydmljZS5zZXRTZWNvbmRzKG5ld0RhdGUsIHNlY29uZHMpO1xuICAgIG5ld0RhdGUgPSB0aGlzLmRhdGVTZXJ2aWNlLnNldE1pbGxpc2Vjb25kcyhuZXdEYXRlLCBtaWxsaXNlY29uZHMpO1xuXG4gICAgdGhpcy5kYXRlID0gbmV3RGF0ZTtcbiAgfVxuXG4gIG9uVGltZUNoYW5nZShzZWxlY3RlZFRpbWU6IE5iU2VsZWN0ZWRUaW1lUGF5bG9hZDxEPik6IHZvaWQge1xuICAgIGxldCBuZXdEYXRlID0gdGhpcy5kYXRlU2VydmljZS5jbG9uZSh0aGlzLmRhdGUpO1xuXG4gICAgbmV3RGF0ZSA9IHRoaXMuZGF0ZVNlcnZpY2Uuc2V0SG91cnMobmV3RGF0ZSwgdGhpcy5kYXRlU2VydmljZS5nZXRIb3VycyhzZWxlY3RlZFRpbWUudGltZSkpO1xuICAgIG5ld0RhdGUgPSB0aGlzLmRhdGVTZXJ2aWNlLnNldE1pbnV0ZXMobmV3RGF0ZSwgdGhpcy5kYXRlU2VydmljZS5nZXRNaW51dGVzKHNlbGVjdGVkVGltZS50aW1lKSk7XG4gICAgbmV3RGF0ZSA9IHRoaXMuZGF0ZVNlcnZpY2Uuc2V0U2Vjb25kcyhuZXdEYXRlLCB0aGlzLmRhdGVTZXJ2aWNlLmdldFNlY29uZHMoc2VsZWN0ZWRUaW1lLnRpbWUpKTtcbiAgICBuZXdEYXRlID0gdGhpcy5kYXRlU2VydmljZS5zZXRNaWxsaXNlY29uZHMobmV3RGF0ZSwgdGhpcy5kYXRlU2VydmljZS5nZXRNaWxsaXNlY29uZHMoc2VsZWN0ZWRUaW1lLnRpbWUpKTtcblxuICAgIHRoaXMuZGF0ZSA9IG5ld0RhdGU7XG4gIH1cblxuICBzYXZlVmFsdWUoKTogdm9pZCB7XG4gICAgdGhpcy5kYXRlQ2hhbmdlLmVtaXQodGhpcy5kYXRlKTtcbiAgfVxuXG4gIHNhdmVDdXJyZW50VGltZSgpOiB2b2lkIHtcbiAgICB0aGlzLmRhdGVDaGFuZ2UuZW1pdCh0aGlzLmRhdGVTZXJ2aWNlLnRvZGF5KCkpO1xuICB9XG5cbiAgc2hvd1NlY29uZHMoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMud2l0aFNlY29uZHMgJiYgIXRoaXMuc2luZ2xlQ29sdW1uO1xuICB9XG5cbiAgaXNMYXJnZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zaXplID09PSBOYkNhbGVuZGFyU2l6ZS5MQVJHRTtcbiAgfVxufVxuIl19